const perPage=10;var editList=!1;const checkAll=document.getElementById("checkAll");function handleCheckAll(){var e=document.querySelectorAll('.form-check-all input[type="checkbox"]'),t=document.querySelectorAll('.form-check-all input[type="checkbox"]:checked').length;const n=this.checked;e.forEach(e=>{e.checked=n,updateRowStyle(e)}),updateRemoveActionsVisibility(t)}function updateRowStyle(e){var t=e.closest("tr");e.checked?t.classList.add("table-active"):t.classList.remove("table-active")}function updateRemoveActionsVisibility(e){var t=document.getElementById("remove-actions");0<e?t.classList.add("d-none"):t.classList.remove("d-none")}checkAll&&checkAll.addEventListener("click",handleCheckAll);var options={valueNames:["id","name","company_name","membership","email_id","phone","date","tags"],page:perPage,pagination:!0,plugins:[ListPagination({left:2,right:2})]};const customerList=new List("customerList",options).on("updated",e=>{0===e.matchingItems.length?document.getElementsByClassName("noresult")[0].style.display="block":document.getElementsByClassName("noresult")[0].style.display="none";var t=1===e.i,n=e.i>e.matchingItems.length-e.page,a=document.querySelector(".pagination-prev.disabled"),i=document.querySelector(".pagination-next.disabled"),a=(a&&a.classList.remove("disabled"),i&&i.classList.remove("disabled"),t&&document.querySelector(".pagination-prev").classList.add("disabled"),n&&document.querySelector(".pagination-next").classList.add("disabled"),document.getElementById("pagination-element")),i=(e.matchingItems.length<=1?a.style.display="none":a.style.display="flex",0<e.matchingItems.length?document.getElementsByClassName("noresult")[0].style.display="none":document.getElementsByClassName("noresult")[0].style.display="block",e.matchingItems.length==perPage&&document.querySelector(".pagination.listjs-pagination").firstElementChild.children[0].click(),customerList.listContainer.querySelector(".total-records")),t=customerList.listContainer.querySelector(".showing");i&&(i.innerHTML=customerList.items.length),t&&(t.innerHTML=customerList.visibleItems.length)}),xhttp=new XMLHttpRequest;xhttp.onload=function(){var e=JSON.parse(this.responseText);Array.from(e).forEach(function(e){var t=e.tags,n='<div class="d-flex gap-1">';Array.from(t).forEach((e,t)=>{n+='<span class="badge bg-light text-body">'+e+"</span>"}),n+="</div>",customerList.add({id:`<a href="/apps/customers/overview" class="fw-medium link-primary">#TB${e.id}</a>`,name:'<div class="d-flex align-items-center gap-2">                    <div class="flex-shrink-0">                        <img src="'+e.customer[0].img+'" alt="" class="avatar-xxs rounded-circle">                    </div>                    <a href="/apps/customers/overview" class="text-reset"><h6 class="mb-0 flex-grow-1 text-reset contactname">'+e.customer[0].name+"</h6></a>                </div>",company_name:e.company_name,membership:isMembership(e.membership).outerHTML,email_id:e.email,phone:e.phone,date:e.create_date,tags:n}),customerList.sort("id",{order:"desc"}),refreshCallbacks(),ischeckboxcheck()}),customerList.remove("id",'<a href="/apps/customers/overview" class="fw-medium link-primary">#TB01</a>')},xhttp.open("GET","/static/json/customer-list.json"),xhttp.send(),document.querySelector("#customer-image-input").addEventListener("change",function(){var e=document.querySelector("#customer-img"),t=document.querySelector("#customer-image-input").files[0],n=new FileReader;n.addEventListener("load",function(){e.src=n.result},!1),t&&n.readAsDataURL(t)});var idField=document.getElementById("id-field"),customerImg=document.getElementById("customer-img"),customerNameField=document.getElementById("customername-field"),company_nameField=document.getElementById("company_name-field"),membershipField=document.getElementById("membership-field"),tagInputField=document.getElementById("taginput-choices"),email_idField=document.getElementById("email_id-field"),phoneField=document.getElementById("phone-field"),removeBtns=document.getElementsByClassName("remove-item-btn"),editBtns=document.getElementsByClassName("edit-item-btn"),membershipVal=new Choices(membershipField,{searchEnabled:!1}),tagInputVal=new Choices(tagInputField,{removeItemButton:!0});function isMembership(e){var t=document.createElement("span");switch(e){case"Golden":t.classList.add("badge","bg-warning"),t.textContent=e;break;case"Sliver":t.classList.add("badge","bg-info"),t.textContent=e;break;case"Basic":t.classList.add("badge","bg-secondary"),t.textContent=e;break;default:t.classList.add("badge","bg-info"),t.textContent=e}return t}var itemId,count=14,dateValue=(new Date).toUTCString().slice(5,16),forms=document.querySelectorAll(".tablelist-form");function ischeckboxcheck(){Array.from(document.getElementsByName("chk_child")).forEach(function(a){a.addEventListener("change",function(e){var e=e.target.closest("tr"),t=(console.log(e),a.checked?e.classList.add("table-active"):e.classList.remove("table-active"),document.querySelectorAll('[name="chk_child"]:checked').length),n=document.getElementById("remove-actions");e.classList.contains("table-active"),n.classList.toggle("d-none",t<=0)})})}function refreshCallbacks(){editBtns&&Array.from(editBtns).forEach(function(e){e.addEventListener("click",function(e){e.target.closest("tr").children[1].innerText,itemId=e.target.closest("tr").children[1].innerText;e=customerList.get({id:itemId});console.log(itemId,e),Array.from(e).forEach(function(e){var t,n=(new DOMParser).parseFromString(e._values.id,"text/html").body.firstElementChild.innerHTML;n==itemId&&(t=(new DOMParser).parseFromString(e._values.tags,"text/html").body.querySelectorAll("span.badge"),editList=!0,idField.value=n,customerImg.src=(new DOMParser).parseFromString(e._values.name,"text/html").body.querySelector("img").src,customerNameField.value=(new DOMParser).parseFromString(e._values.name,"text/html").body.querySelector(".contactname").innerHTML,company_nameField.value=e._values.company_name,email_idField.value=e._values.email_id,phoneField.value=e._values.phone,membershipVal&&membershipVal.destroy(),(membershipVal=new Choices(membershipField,{removeItemButton:!0})).setChoiceByValue((new DOMParser).parseFromString(e._values.membership,"text/html").body.querySelector("span.badge").innerHTML),t)&&(tagInputVal&&tagInputVal.destroy(),tagInputVal=new Choices(tagInputField,{removeItemButton:!0}),Array.from(t).forEach(e=>{tagInputVal.setChoiceByValue(e.innerHTML)}))})})}),removeBtns&&Array.from(removeBtns).forEach(function(e){e.addEventListener("click",function(e){e.target.closest("tr").children[1].innerText;var n=e.target.closest("tr").children[1].innerText,e=(console.log("delete",n),customerList.get({id:n}));Array.from(e).forEach(function(e){var t=(deleteid=(new DOMParser).parseFromString(e._values.id,"text/html")).body.firstElementChild;deleteid.body.firstElementChild.innerHTML==n&&document.getElementById("delete-record").addEventListener("click",function(){customerList.remove("id",t.outerHTML),document.getElementById("deleteRecord-close").click()})})})})}function clearFields(){editList=!1,idField.value="",customerImg.src="https://img.themesbrand.com/judia/users/user-dummy-img.jpg",document.getElementById("customer-image-input").value="",customerNameField.value="",company_nameField.value="",membershipField.value="",email_idField.value="",phoneField.value="",tagInputField.value="",membershipVal&&membershipVal.destroy(),membershipVal=new Choices(membershipField,{searchEnabled:!1}),tagInputVal&&tagInputVal.destroy(),tagInputVal=new Choices(tagInputField,{removeItemButton:!0})}function deleteMultiple(){const t=[];var e,n=document.getElementsByName("chk_child");for(i=0;i<n.length;i++)1==n[i].checked&&(e=n[i].parentNode.parentNode.parentNode.querySelector("td a").innerHTML,t.push(e));void 0!==t&&0<t.length?Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,customClass:{confirmButton:"btn btn-primary w-xs me-2 mt-2",cancelButton:"btn btn-danger w-xs mt-2"},confirmButtonText:"Yes, delete it!",buttonsStyling:!1,showCloseButton:!0}).then(function(e){if(e.value){for(i=0;i<t.length;i++)customerList.remove("id",`<a href="/apps/customers/overview" class="fw-medium link-primary">${t[i]}</a>`);document.getElementById("remove-actions").classList.add("d-none"),document.getElementById("checkAll").checked=!1,Swal.fire({title:"Deleted!",text:"Your data has been deleted.",icon:"success",customClass:{confirmButton:"btn btn-info w-xs mt-2"},buttonsStyling:!1})}}):Swal.fire({title:"Please select at least one checkbox",customClass:{confirmButton:"btn btn-info"},buttonsStyling:!1,showCloseButton:!0})}Array.prototype.slice.call(forms).forEach(function(e){e.addEventListener("submit",function(e){e.preventDefault();var t=document.getElementById("alert-error-msg");t.classList.remove("d-none"),setTimeout(()=>t.classList.add("d-none"),2e3);let n=!0;[{input:customerNameField,error:"Please enter a customer name."},{input:company_nameField,error:"Please enter a company name."},{input:membershipField,error:"Please select a select membership."},{input:email_idField,error:"Please enter a email address."},{input:phoneField,error:"Please enter a phone no."},{input:tagInputField,error:"Please select a tags."}].forEach(function(e){n&&""===e.input.value.trim()?(t.innerHTML=e.error,e.input.classList.add("is-invalid"),n=!1):e.input.classList.remove("is-invalid")});var e=tagInputVal.getValue(!0),a="";return Array.from(e).forEach((e,t)=>{a+='<span class="badge bg-light text-body">'+e+"</span>"}),!editList&&n?(customerList.add({id:`<a href="/apps/customers/overview" class="fw-medium link-primary">#TB${count}</a>`,name:'<div class="d-flex align-items-center gap-2">                    <div class="flex-shrink-0">                        <img src="'+customerImg.src+'" alt="" class="avatar-xxs rounded-circle">                    </div>                    <a href="/apps/customers/overview" class="text-reset"><h6 class="mb-0 flex-grow-1 text-reset contactname">'+customerNameField.value+"</h6></a>                </div>",company_name:company_nameField.value,membership:isMembership(membershipField.value).outerHTML,email_id:email_idField.value,phone:phoneField.value,date:dateValue,tags:a}),customerList.sort("id",{order:"desc"}),document.getElementById("alert-error-msg").classList.add("d-none"),document.getElementById("close-modal").click(),count++,clearFields(),refreshCallbacks(),Swal.fire({position:"center",icon:"success",title:"Customer details inserted successfully!",showConfirmButton:!1,timer:2e3,showCloseButton:!0})):editList&&n&&(e=customerList.get({id:idField.value}),Array.from(e).forEach(function(e){(new DOMParser).parseFromString(e._values.id,"text/html").body.firstElementChild.innerHTML==itemId&&e.values({id:`<a href="/apps/customers/overview" class="fw-medium link-primary">#TB${idField.value}</a>`,name:'<div class="d-flex align-items-center gap-2">                            <div class="flex-shrink-0">                                <img src="'+customerImg.src+'" alt="" class="avatar-xxs rounded-circle">                            </div>                            <a href="/apps/customers/overview" class="text-reset"><h6 class="mb-0 flex-grow-1 text-reset contactname">'+customerNameField.value+"</h6></a>                        </div>",company_name:company_nameField.value,membership:isMembership(membershipField.value).outerHTML,email_id:email_idField.value,phone:phoneField.value,date:dateValue,tags:a})}),document.getElementById("alert-error-msg").classList.add("d-none"),document.getElementById("close-modal").click(),clearFields(),Swal.fire({position:"center",icon:"success",title:"Customer details updated successfully!",showConfirmButton:!1,timer:2e3,showCloseButton:!0})),!0})}),document.getElementById("showModal").addEventListener("show.bs.modal",function(e){e.relatedTarget.classList.contains("edit-item-btn")?(document.getElementById("exampleModalLabel").innerHTML="Edit Customer",document.getElementById("showModal").querySelector(".modal-footer").style.display="block",document.getElementById("add-btn").innerHTML="Update"):e.relatedTarget.classList.contains("add-btn")?(document.getElementById("exampleModalLabel").innerHTML="Add Customer",document.getElementById("showModal").querySelector(".modal-footer").style.display="block",document.getElementById("add-btn").innerHTML="Add Customer"):(document.getElementById("exampleModalLabel").innerHTML="List product",document.getElementById("showModal").querySelector(".modal-footer").style.display="none")}),document.getElementById("showModal").addEventListener("hidden.bs.modal",function(){clearFields()}),document.querySelector(".pagination-next").addEventListener("click",function(){document.querySelector(".pagination.listjs-pagination")&&document.querySelector(".pagination.listjs-pagination").querySelector(".active")&&null!=document.querySelector(".pagination.listjs-pagination").querySelector(".active").nextElementSibling&&document.querySelector(".pagination.listjs-pagination").querySelector(".active").nextElementSibling.children[0].click(),refreshCallbacks(),ischeckboxcheck()}),document.querySelector(".pagination-prev").addEventListener("click",function(){document.querySelector(".pagination.listjs-pagination")&&document.querySelector(".pagination.listjs-pagination").querySelector(".active")&&null!=document.querySelector(".pagination.listjs-pagination").querySelector(".active").previousSibling&&document.querySelector(".pagination.listjs-pagination").querySelector(".active").previousSibling.children[0].click(),refreshCallbacks(),ischeckboxcheck()});